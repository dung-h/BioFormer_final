================================================================================
GENE OVERLAP ANALYSIS FOR HVG SELECTION
================================================================================

1. LOADING DATASETS AND EXTRACTING GENES...
  Loading data1.h5ad...
    29,586 genes found
  Loading data2.h5ad...
    32,034 genes found
  Loading data3.h5ad...
    33,105 genes found
  Loading data4.h5ad...
    23,586 genes found
  Loading data5.h5ad...
    26,252 genes found
  Loading data6.h5ad...
    26,405 genes found
  Loading data7.h5ad...
    59,229 genes found
  Loading data8.h5ad...
    59,229 genes found
  Loading data9.h5ad...
    33,145 genes found
  Loading data10.h5ad...
    45,454 genes found
  Loading data11.h5ad...
    27,235 genes found
  Loading data12.h5ad...
    33,053 genes found
  Loading data13.h5ad...
    61,759 genes found
  Loading data14.h5ad...
    33,145 genes found
  Loading data15.h5ad...
    32,839 genes found
  Loading data16.h5ad...
    25,840 genes found
  Loading data17.h5ad...
    45,454 genes found
  Loading data18.h5ad...
    34,455 genes found
  Loading data19.h5ad...
    31,180 genes found
  Loading data20.h5ad...
    35,767 genes found
  Loading data21.h5ad...
    36,088 genes found
  Loading data22.h5ad...
    22,781 genes found
  Loading data23.h5ad...
    36,406 genes found
  Loading data24.h5ad...
    24,651 genes found
  Loading data25.h5ad...
    37,050 genes found
  Loading data26.h5ad...
    59,229 genes found
  Loading data27.h5ad...
    29,968 genes found
  Loading data28.h5ad...
    36,406 genes found
  Loading data29.h5ad...
    25,484 genes found
  Loading data30.h5ad...
    45,854 genes found

2. GENE OVERLAP STATISTICS:
   Total datasets analyzed: 30
   Total unique genes across all datasets: 159,410
   Genes present in â‰¥ 1 datasets: 159,410
   Genes present in â‰¥ 2 datasets: 89,658
   Genes present in â‰¥ 5 datasets: 53,186
   Genes present in â‰¥10 datasets: 37,517
   Genes present in â‰¥15 datasets: 32,375
   Genes present in â‰¥20 datasets: 26,340
   Genes present in â‰¥25 datasets: 16,706

3. MOST COMMON GENES (present in most datasets):
    1. NAV2-AS3             - in 27/30 datasets
    2. WWTR1-AS1            - in 27/30 datasets
    3. DNM3OS               - in 27/30 datasets
    4. NFYC-AS1             - in 27/30 datasets
    5. LINC00649            - in 27/30 datasets
    6. NNT-AS1              - in 27/30 datasets
    7. FAM53B-AS1           - in 27/30 datasets
    8. ZNF503-AS1           - in 27/30 datasets
    9. GNG12-AS1            - in 27/30 datasets
   10. LINC00954            - in 27/30 datasets
   11. FCGR2B               - in 27/30 datasets
   12. PCAT1                - in 27/30 datasets
   13. TMEM44-AS1           - in 27/30 datasets
   14. LINC01134            - in 27/30 datasets
   15. LINC02227            - in 27/30 datasets
   16. STXBP5-AS1           - in 27/30 datasets
   17. ZFAS1                - in 27/30 datasets
   18. TAPT1-AS1            - in 27/30 datasets
   19. NAPA-AS1             - in 27/30 datasets
   20. ADORA2A-AS1          - in 27/30 datasets

4. HVG RECOMMENDATIONS:
   Original training: 4,000,000 cells, 1,000 HVGs
   Current training:  14,600,000 cells
   Cell scaling factor: 1.91x

   OPTION 1 - Based on gene coverage:
   Genes in â‰¥90% datasets: 660
   Genes in â‰¥75% datasets: 19,700
   Genes in â‰¥50% datasets: 32,375

   OPTION 2 - Scaled from original training:
   3,000 HVGs: âœ… FEASIBLE (need 3,000, have 37,517 in â‰¥10 datasets)
   4,000 HVGs: âœ… FEASIBLE (need 4,000, have 37,517 in â‰¥10 datasets)
   5,000 HVGs: âœ… FEASIBLE (need 5,000, have 37,517 in â‰¥10 datasets)
   6,000 HVGs: âœ… FEASIBLE (need 6,000, have 37,517 in â‰¥10 datasets)

5. DETAILED RECOMMENDATION:
   Gene availability by minimum dataset presence:
     â‰¥ 5 datasets: 53,186 genes
     â‰¥10 datasets: 37,517 genes
     â‰¥15 datasets: 32,375 genes
     â‰¥20 datasets: 26,340 genes

   FINAL RECOMMENDATIONS:
   ðŸŽ¯ RECOMMENDED: 5,000 HVGs
      - Excellent coverage (32,375 genes in â‰¥15 datasets)
      - Good scaling from 1Kâ†’5K with 4Mâ†’14.6M cells
      - Balances diversity with dataset coverage

   TRAINING CONSIDERATIONS:
   - Use genes present in â‰¥10 datasets for stability
   - Consider stratified sampling by cell type
   - Monitor for dataset-specific biases
   - Validate on held-out datasets

6. SAVING ANALYSIS RESULTS...
   Results saved to:
   - common_genes_analysis.csv
   - gene_overlap_stats.csv
