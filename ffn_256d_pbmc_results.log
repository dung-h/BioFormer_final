
============================================================
Running FFN BioFormer Integration Test: /home/tripham/scgpt/benchmark/preprocessed_pbmc
Checkpoint: /mnt/nasdev2/dung/preprocessed/training1/checkpoints/checkpoint_epoch_2_20250705_082455.pt
============================================================
Loaded 1000 genes from vocabulary
Loaded 11990 cells from 2 studies
Found 9 unique cell types
Loading FFN BioFormer model...
Skipping cell_type_embedding.weight due to shape mismatch or missing key
FFN model loaded successfully
Extracting embeddings...
Processing batches:   0%|          | 0/188 [00:00<?, ?it/s]Processing batches:   1%|          | 1/188 [00:00<00:37,  4.98it/s]Processing batches:   2%|▏         | 3/188 [00:00<00:22,  8.26it/s]Processing batches:   3%|▎         | 5/188 [00:00<00:19,  9.41it/s]Processing batches:   4%|▎         | 7/188 [00:00<00:18,  9.96it/s]Processing batches:   5%|▍         | 9/188 [00:00<00:17, 10.27it/s]Processing batches:   6%|▌         | 11/188 [00:01<00:16, 10.46it/s]Processing batches:   7%|▋         | 13/188 [00:01<00:16, 10.57it/s]Processing batches:   8%|▊         | 15/188 [00:01<00:16, 10.65it/s]Processing batches:   9%|▉         | 17/188 [00:01<00:16, 10.68it/s]Processing batches:  10%|█         | 19/188 [00:01<00:15, 10.71it/s]Processing batches:  11%|█         | 21/188 [00:02<00:15, 10.73it/s]Processing batches:  12%|█▏        | 23/188 [00:02<00:15, 10.75it/s]Processing batches:  13%|█▎        | 25/188 [00:02<00:15, 10.78it/s]Processing batches:  14%|█▍        | 27/188 [00:02<00:14, 10.79it/s]Processing batches:  15%|█▌        | 29/188 [00:02<00:14, 10.80it/s]Processing batches:  16%|█▋        | 31/188 [00:02<00:14, 10.80it/s]Processing batches:  18%|█▊        | 33/188 [00:03<00:14, 10.81it/s]Processing batches:  19%|█▊        | 35/188 [00:03<00:14, 10.81it/s]Processing batches:  20%|█▉        | 37/188 [00:03<00:13, 10.81it/s]Processing batches:  21%|██        | 39/188 [00:03<00:13, 10.81it/s]Processing batches:  22%|██▏       | 41/188 [00:03<00:13, 10.82it/s]Processing batches:  23%|██▎       | 43/188 [00:04<00:13, 10.82it/s]Processing batches:  24%|██▍       | 45/188 [00:04<00:13, 10.82it/s]Processing batches:  25%|██▌       | 47/188 [00:04<00:13, 10.82it/s]Processing batches:  26%|██▌       | 49/188 [00:04<00:12, 10.82it/s]Processing batches:  27%|██▋       | 51/188 [00:04<00:12, 10.82it/s]Processing batches:  28%|██▊       | 53/188 [00:05<00:12, 10.82it/s]Processing batches:  29%|██▉       | 55/188 [00:05<00:12, 10.82it/s]Processing batches:  30%|███       | 57/188 [00:05<00:12, 10.81it/s]Processing batches:  31%|███▏      | 59/188 [00:05<00:11, 10.81it/s]Processing batches:  32%|███▏      | 61/188 [00:05<00:11, 10.80it/s]Processing batches:  34%|███▎      | 63/188 [00:05<00:11, 10.79it/s]Processing batches:  35%|███▍      | 65/188 [00:06<00:11, 10.79it/s]Processing batches:  36%|███▌      | 67/188 [00:06<00:11, 10.75it/s]Processing batches:  37%|███▋      | 69/188 [00:06<00:11, 10.75it/s]Processing batches:  38%|███▊      | 71/188 [00:06<00:10, 10.75it/s]Processing batches:  39%|███▉      | 73/188 [00:06<00:10, 10.74it/s]Processing batches:  40%|███▉      | 75/188 [00:07<00:10, 10.55it/s]Processing batches:  41%|████      | 77/188 [00:07<00:10, 10.32it/s]Processing batches:  42%|████▏     | 79/188 [00:07<00:10, 10.18it/s]Processing batches:  43%|████▎     | 81/188 [00:07<00:10, 10.07it/s]Processing batches:  44%|████▍     | 83/188 [00:07<00:11,  9.09it/s]Processing batches:  45%|████▍     | 84/188 [00:08<00:12,  8.13it/s]Processing batches:  45%|████▌     | 85/188 [00:08<00:13,  7.44it/s]Processing batches:  46%|████▌     | 86/188 [00:08<00:14,  6.83it/s]Processing batches:  46%|████▋     | 87/188 [00:08<00:15,  6.50it/s]Processing batches:  47%|████▋     | 88/188 [00:08<00:16,  6.16it/s]Processing batches:  47%|████▋     | 89/188 [00:09<00:16,  5.99it/s]Processing batches:  48%|████▊     | 90/188 [00:09<00:16,  5.82it/s]Processing batches:  48%|████▊     | 91/188 [00:09<00:17,  5.65it/s]Processing batches:  49%|████▉     | 92/188 [00:09<00:17,  5.63it/s]Processing batches:  49%|████▉     | 93/188 [00:09<00:17,  5.53it/s]Processing batches:  50%|█████     | 94/188 [00:09<00:16,  5.56it/s]Processing batches:  51%|█████     | 95/188 [00:10<00:16,  5.50it/s]Processing batches:  51%|█████     | 96/188 [00:10<00:16,  5.52it/s]Processing batches:  52%|█████▏    | 97/188 [00:10<00:16,  5.49it/s]Processing batches:  52%|█████▏    | 98/188 [00:10<00:16,  5.44it/s]Processing batches:  53%|█████▎    | 99/188 [00:10<00:16,  5.48it/s]Processing batches:  53%|█████▎    | 100/188 [00:11<00:16,  5.43it/s]Processing batches:  54%|█████▎    | 101/188 [00:11<00:15,  5.47it/s]Processing batches:  54%|█████▍    | 102/188 [00:11<00:15,  5.44it/s]Processing batches:  55%|█████▍    | 103/188 [00:11<00:15,  5.47it/s]Processing batches:  55%|█████▌    | 104/188 [00:11<00:15,  5.46it/s]Processing batches:  56%|█████▌    | 105/188 [00:11<00:15,  5.41it/s]Processing batches:  56%|█████▋    | 106/188 [00:12<00:15,  5.46it/s]Processing batches:  57%|█████▋    | 107/188 [00:12<00:14,  5.41it/s]Processing batches:  57%|█████▋    | 108/188 [00:12<00:14,  5.46it/s]Processing batches:  58%|█████▊    | 109/188 [00:12<00:14,  5.43it/s]Processing batches:  59%|█████▊    | 110/188 [00:12<00:14,  5.44it/s]Processing batches:  59%|█████▉    | 111/188 [00:13<00:14,  5.46it/s]Processing batches:  60%|█████▉    | 112/188 [00:13<00:14,  5.41it/s]Processing batches:  60%|██████    | 113/188 [00:13<00:13,  5.46it/s]Processing batches:  61%|██████    | 114/188 [00:13<00:13,  5.43it/s]Processing batches:  61%|██████    | 115/188 [00:13<00:13,  5.47it/s]Processing batches:  62%|██████▏   | 116/188 [00:14<00:13,  5.44it/s]Processing batches:  62%|██████▏   | 117/188 [00:14<00:13,  5.45it/s]Processing batches:  63%|██████▎   | 118/188 [00:14<00:12,  5.47it/s]Processing batches:  63%|██████▎   | 119/188 [00:14<00:12,  5.44it/s]Processing batches:  64%|██████▍   | 120/188 [00:14<00:12,  5.48it/s]Processing batches:  64%|██████▍   | 121/188 [00:14<00:12,  5.43it/s]Processing batches:  65%|██████▍   | 122/188 [00:15<00:12,  5.47it/s]Processing batches:  65%|██████▌   | 123/188 [00:15<00:11,  5.44it/s]Processing batches:  66%|██████▌   | 124/188 [00:15<00:11,  5.47it/s]Processing batches:  66%|██████▋   | 125/188 [00:15<00:11,  5.46it/s]Processing batches:  67%|██████▋   | 126/188 [00:15<00:11,  5.42it/s]Processing batches:  68%|██████▊   | 127/188 [00:16<00:11,  5.46it/s]Processing batches:  68%|██████▊   | 128/188 [00:16<00:11,  5.44it/s]Processing batches:  69%|██████▊   | 129/188 [00:16<00:10,  5.47it/s]Processing batches:  69%|██████▉   | 130/188 [00:16<00:10,  5.45it/s]Processing batches:  70%|██████▉   | 131/188 [00:16<00:10,  5.50it/s]Processing batches:  70%|███████   | 132/188 [00:16<00:10,  5.46it/s]Processing batches:  71%|███████   | 133/188 [00:17<00:10,  5.48it/s]Processing batches:  71%|███████▏  | 134/188 [00:17<00:09,  5.47it/s]Processing batches:  72%|███████▏  | 135/188 [00:17<00:09,  5.42it/s]Processing batches:  72%|███████▏  | 136/188 [00:17<00:09,  5.46it/s]Processing batches:  73%|███████▎  | 137/188 [00:17<00:09,  5.42it/s]Processing batches:  73%|███████▎  | 138/188 [00:18<00:09,  5.46it/s]Processing batches:  74%|███████▍  | 139/188 [00:18<00:09,  5.43it/s]Processing batches:  74%|███████▍  | 140/188 [00:18<00:08,  5.46it/s]Processing batches:  75%|███████▌  | 141/188 [00:18<00:08,  5.45it/s]Processing batches:  76%|███████▌  | 142/188 [00:18<00:08,  5.39it/s]Processing batches:  76%|███████▌  | 143/188 [00:18<00:08,  5.42it/s]Processing batches:  77%|███████▋  | 144/188 [00:19<00:08,  5.38it/s]Processing batches:  77%|███████▋  | 145/188 [00:19<00:07,  5.43it/s]Processing batches:  78%|███████▊  | 146/188 [00:19<00:07,  5.43it/s]Processing batches:  78%|███████▊  | 147/188 [00:19<00:07,  5.40it/s]Processing batches:  79%|███████▊  | 148/188 [00:19<00:07,  5.45it/s]Processing batches:  79%|███████▉  | 149/188 [00:20<00:07,  5.41it/s]Processing batches:  80%|███████▉  | 150/188 [00:20<00:06,  5.45it/s]Processing batches:  80%|████████  | 151/188 [00:20<00:06,  5.43it/s]Processing batches:  81%|████████  | 152/188 [00:20<00:06,  5.46it/s]Processing batches:  81%|████████▏ | 153/188 [00:20<00:06,  5.45it/s]Processing batches:  82%|████████▏ | 154/188 [00:20<00:06,  5.41it/s]Processing batches:  82%|████████▏ | 155/188 [00:21<00:06,  5.46it/s]Processing batches:  83%|████████▎ | 156/188 [00:21<00:05,  5.41it/s]Processing batches:  84%|████████▎ | 157/188 [00:21<00:05,  5.46it/s]Processing batches:  84%|████████▍ | 158/188 [00:21<00:05,  5.43it/s]Processing batches:  85%|████████▍ | 159/188 [00:21<00:05,  5.47it/s]Processing batches:  85%|████████▌ | 160/188 [00:22<00:05,  5.46it/s]Processing batches:  86%|████████▌ | 161/188 [00:22<00:04,  5.42it/s]Processing batches:  86%|████████▌ | 162/188 [00:22<00:04,  5.46it/s]Processing batches:  87%|████████▋ | 163/188 [00:22<00:04,  5.41it/s]Processing batches:  87%|████████▋ | 164/188 [00:22<00:04,  5.46it/s]Processing batches:  88%|████████▊ | 165/188 [00:23<00:04,  5.43it/s]Processing batches:  88%|████████▊ | 166/188 [00:23<00:04,  5.47it/s]Processing batches:  89%|████████▉ | 167/188 [00:23<00:03,  5.46it/s]Processing batches:  89%|████████▉ | 168/188 [00:23<00:03,  5.42it/s]Processing batches:  90%|████████▉ | 169/188 [00:23<00:03,  5.46it/s]Processing batches:  90%|█████████ | 170/188 [00:23<00:03,  5.44it/s]Processing batches:  91%|█████████ | 171/188 [00:24<00:03,  5.47it/s]Processing batches:  91%|█████████▏| 172/188 [00:24<00:02,  5.43it/s]Processing batches:  92%|█████████▏| 173/188 [00:24<00:02,  5.44it/s]Processing batches:  93%|█████████▎| 174/188 [00:24<00:02,  5.46it/s]Processing batches:  93%|█████████▎| 175/188 [00:24<00:02,  5.41it/s]Processing batches:  94%|█████████▎| 176/188 [00:25<00:02,  5.46it/s]Processing batches:  94%|█████████▍| 177/188 [00:25<00:02,  5.41it/s]Processing batches:  95%|█████████▍| 178/188 [00:25<00:01,  5.47it/s]Processing batches:  95%|█████████▌| 179/188 [00:25<00:01,  5.44it/s]Processing batches:  96%|█████████▌| 180/188 [00:25<00:01,  5.45it/s]Processing batches:  96%|█████████▋| 181/188 [00:25<00:01,  5.46it/s]Processing batches:  97%|█████████▋| 182/188 [00:26<00:01,  5.41it/s]Processing batches:  97%|█████████▋| 183/188 [00:26<00:00,  5.46it/s]Processing batches:  98%|█████████▊| 184/188 [00:26<00:00,  5.41it/s]Processing batches:  98%|█████████▊| 185/188 [00:26<00:00,  5.48it/s]Processing batches:  99%|█████████▉| 186/188 [00:26<00:00,  5.44it/s]Processing batches:  99%|█████████▉| 187/188 [00:27<00:00,  5.47it/s]Processing batches: 100%|██████████| 188/188 [00:27<00:00,  6.93it/s]
Extracted embeddings shape: (11990, 256)

FFN BioFormer Results:
  NMI = 0.7345
  ARI = 0.3225
  Silhouette = 0.8933
  Graph connectivity = 1.0000
  AvgBIO = 0.6501
  AvgBATCH = 1.0000

FFN Integration Test Completed!
